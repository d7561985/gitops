api_route: /api/

clusters:
  # gRPC сервис (fake-service в gRPC режиме)
  - name: web
    addr: "web-grpc-sv:9091"
    type: "grpc"

  # HTTP сервис (fake-service в HTTP режиме)
  - name: web-http
    addr: "web-http-sv:9092"
    type: "http"
    health_check:
      path: "/health"
      interval_seconds: 10

  # gRPC Health service (for streaming tests)
  - name: health-demo
    addr: "health-demo-sv:8081"
    type: "grpc"

  # Sentry Demo Services
  - name: sentry-frontend
    addr: "sentry-frontend-sv:4200"
    type: "http"
    health_check:
      path: "/"
      interval_seconds: 30

  - name: sentry-game-engine
    addr: "sentry-game-engine-sv:8082"
    type: "http"
    health_check:
      path: "/health"
      interval_seconds: 10

  - name: sentry-payment
    addr: "sentry-payment-sv:8083"
    type: "http"
    health_check:
      path: "/health"
      interval_seconds: 10

apis:
  # gRPC-Web тестирование
  - name: FakeService
    cluster: web
    auth: {policy: no-need}
    methods:
      - name: Handle
        auth:
          policy: no-need

  # HTTP REST тестирование (public + protected)
  - name: HttpService
    cluster: web-http
    auth: {policy: no-need}
    methods:
      - name: health
        auth: {policy: no-need}
      - name: echo
        auth: {policy: no-need}
      - name: protected
        auth: {policy: required}

  # gRPC Health service (streaming test via Watch method)
  - name: grpc.health.v1.Health
    cluster: health-demo
    auth: {policy: no-need}
    methods:
      - name: Check
        auth: {policy: no-need}

  # Sentry Demo - Frontend (static files)
  - name: SentryFrontend
    cluster: sentry-frontend
    auth: {policy: no-need}
    methods:
      - name: "*"
        auth: {policy: no-need}

  # Sentry Demo - Game Engine API
  - name: SentryGame
    cluster: sentry-game-engine
    auth: {policy: no-need}
    methods:
      - name: health
        auth: {policy: no-need}
      - name: spin
        auth: {policy: required}
      - name: slots
        auth: {policy: no-need}

  # Sentry Demo - Payment API
  - name: SentryPayment
    cluster: sentry-payment
    auth: {policy: no-need}
    methods:
      - name: health
        auth: {policy: no-need}
      - name: deposit
        auth: {policy: required}
      - name: withdraw
        auth: {policy: required}
      - name: balance
        auth: {policy: required}
