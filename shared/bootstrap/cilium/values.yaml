# Minimal Cilium values for bootstrap
# Full configuration managed by ArgoCD layer-0 after bootstrap

# IPAM mode
ipam:
  mode: kubernetes

# Replace kube-proxy
kubeProxyReplacement: true

# Gateway API support
gatewayAPI:
  enabled: true

# L7 proxy for Gateway API
l7Proxy: true

# Talos-specific settings
securityContext:
  capabilities:
    ciliumAgent:
      - CHOWN
      - KILL
      - NET_ADMIN
      - NET_RAW
      - IPC_LOCK
      - SYS_ADMIN
      - SYS_RESOURCE
      - DAC_OVERRIDE
      - FOWNER
      - SETGID
      - SETUID
    cleanCiliumState:
      - NET_ADMIN
      - SYS_ADMIN
      - SYS_RESOURCE

# Disable auto-mount for Talos
cgroup:
  autoMount:
    enabled: false
  hostRoot: /sys/fs/cgroup

# For Talos: connect to kubelet via localhost
k8sServiceHost: localhost
k8sServicePort: 7445

# Single replica for bootstrap (scale via ArgoCD)
operator:
  replicas: 1

# Basic Hubble (UI disabled for bootstrap, enable via ArgoCD)
hubble:
  enabled: true
  relay:
    enabled: true
  ui:
    enabled: false  # Enable via ArgoCD layer-0
