# =============================================================================
# HTTPRoute Configuration for k8app
# =============================================================================
# This shows the values.yaml structure for HTTPRoute support in k8app.
# Add this section to the default values.yaml of k8app chart.

# HTTPRoute - Gateway API routing (alternative to Ingress)
httpRoute:
  enabled: false

  # Annotations for the HTTPRoute resource
  annotations: {}

  # Primary host (used for labeling, helps with mirror sync)
  # primaryHost: app.example.com

  # Parent Gateway references
  # At least one parentRef is required
  parentRefs:
    - name: gateway-dev          # Gateway name
      namespace: gateway-dev     # Gateway namespace
      sectionName: https-app     # Optional: specific listener name

  # Hostnames to match
  # If empty, matches all hostnames on the referenced Gateway listeners
  hostnames:
    - app.example.com

  # Routing rules
  # If empty, creates a default rule routing all traffic to this service
  rules:
    # Example: Route /api to api-gateway, everything else to this service
    - matches:
        - path:
            type: PathPrefix
            value: /api
      backendRefs:
        - name: api-gateway-sv
          port: 8080
          # namespace: other-ns  # Optional: cross-namespace routing

    # Catch-all rule (routes to this service by default)
    - matches:
        - path:
            type: PathPrefix
            value: /
      # backendRefs omitted = routes to this service

# =============================================================================
# Example Configurations
# =============================================================================

# -----------------------------------------------------------------------------
# Example 1: Simple frontend with API routing
# -----------------------------------------------------------------------------
# httpRoute:
#   enabled: true
#   parentRefs:
#     - name: gateway-dev
#       namespace: gateway-dev
#       sectionName: https-app
#   hostnames:
#     - app.example.com
#   rules:
#     - matches:
#         - path:
#             type: PathPrefix
#             value: /api
#       backendRefs:
#         - name: api-gateway-sv
#           port: 8080
#     - matches:
#         - path:
#             type: PathPrefix
#             value: /

# -----------------------------------------------------------------------------
# Example 2: API-only service
# -----------------------------------------------------------------------------
# httpRoute:
#   enabled: true
#   parentRefs:
#     - name: gateway-dev
#       namespace: gateway-dev
#       sectionName: https-api
#   hostnames:
#     - api.example.com
#   rules:
#     - matches:
#         - path:
#             type: PathPrefix
#             value: /

# -----------------------------------------------------------------------------
# Example 3: Header-based routing (A/B testing)
# -----------------------------------------------------------------------------
# httpRoute:
#   enabled: true
#   parentRefs:
#     - name: gateway-dev
#       namespace: gateway-dev
#   hostnames:
#     - app.example.com
#   rules:
#     - matches:
#         - path:
#             type: PathPrefix
#             value: /
#           headers:
#             - name: X-Version
#               value: beta
#       backendRefs:
#         - name: frontend-beta-sv
#           port: 80
#     - matches:
#         - path:
#             type: PathPrefix
#             value: /
#       backendRefs:
#         - name: frontend-sv
#           port: 80

# -----------------------------------------------------------------------------
# Example 4: Traffic splitting (canary deployment)
# -----------------------------------------------------------------------------
# httpRoute:
#   enabled: true
#   parentRefs:
#     - name: gateway-dev
#       namespace: gateway-dev
#   hostnames:
#     - app.example.com
#   rules:
#     - matches:
#         - path:
#             type: PathPrefix
#             value: /
#       backendRefs:
#         - name: frontend-sv
#           port: 80
#           weight: 90
#         - name: frontend-canary-sv
#           port: 80
#           weight: 10
