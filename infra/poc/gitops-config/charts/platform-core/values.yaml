# =============================================================================
# Platform Core - Default Values
# =============================================================================
# Core infrastructure for application deployment.
# Creates namespaces, gateways, applicationsets, vault auth.
#
# Sync Waves (deployment order):
#   -10: Bootstrap Job (Vault policies, roles, secrets)
#   -2:  Namespaces (poc-dev, infra-dev, poc-staging, infra-staging)
#   -1:  Infrastructure apps (MongoDB, RabbitMQ â†’ infra-{env})
#    0:  Backend services (user-service, game-engine, payment, wager)
#    1:  API Gateway
#    2:  Frontend
# =============================================================================

# Inherited from base.yaml
global: {}
environments: {}
services: {}
vault: {}
vaultAuth: {}
registry: {}
dns: {}
ingress: {}

# Infrastructure Applications (MongoDB, RabbitMQ per environment)
infra:
  enabled: true

# Namespaces
namespaces:
  enabled: true
  labels:
    app.kubernetes.io/managed-by: platform-core

# Gateway for environments
gateway:
  enabled: true
  gatewayClassName: cilium
  listener:
    name: http-app
    protocol: HTTP
    port: 80
  certManager:
    enabled: false

# Domain mirrors
domainMirrors:
  enabled: true
  addToGateway: true
  createDNS: true
  addToTunnel: true
  defaultRoutes:
    - name: api
      path: /api
      pathType: PathPrefix
      serviceName: api-gw-sv
      servicePort: 8080
    - name: frontend
      path: /
      pathType: PathPrefix
      serviceName: sentry-frontend-sv
      servicePort: 4200

# ApplicationSet for services
applicationSet:
  enabled: true
  name: gitops-services
  project: ""  # Set in values

# Bootstrap job for Vault
job:
  enabled: true
  image: hashicorp/vault:1.15
  backoffLimit: 3
  ttlSecondsAfterFinished: 300
  hook: PreSync
  hookDeletePolicy: HookSucceeded
  syncWave: "-10"

# Preview environments support (for gateway listener)
previewEnvironments:
  enabled: false
